# 消费模式变化检测 - 核心逻辑图 (ASCII版本)

## 1. 整体数据流

```
账单数据 → 解析清洗 → 商品识别 → 模式分析 → 异常检测 → 智能过滤 → 用户洞察
    ↓           ↓           ↓           ↓           ↓           ↓           ↓
[CSV/Excel] [去重标准化] [相同商品归类] [时间维度分析] [变化检测算法] [重要性筛选] [推送/展示]
```

## 2. 核心决策树

```
检测到消费变化
├── 频率变化 (如：加油间隔缩短)
│   ├── 变化幅度 > 30% → 高优先级提醒
│   ├── 变化幅度 15-30% → 中优先级记录
│   └── 变化幅度 < 15% → 静默记录
│
├── 金额变化 (如：相同商品涨价)
│   ├── 涨幅 > 20% → 立即提醒
│   ├── 涨幅 10-20% → 周报汇总
│   └── 涨幅 < 10% → 月报记录
│
└── 地点变化 (如：换了新的购物场所)
    ├── 完全替代 → 分析原因
    ├── 部分替代 → 观察趋势
    └── 偶尔变化 → 正常波动
```

## 3. 智能过滤机制

```
原始检测结果 (100%)
        ↓
    置信度评估
        ↓
    ┌─────────────────┬─────────────────┬─────────────────┐
    ↓                 ↓                 ↓                 ↓
高置信度 (20%)    中置信度 (40%)    低置信度 (40%)    噪音数据
立即推送          周报汇总          静默记录          直接过滤
```

## 4. 用户交互层级

```
第一层：关键洞察 (立即推送)
└── "你的猫粮消耗速度加快了40%，可能分量变少了"

第二层：趋势观察 (仪表板展示)
└── "最近3个月加油频率略有增加"

第三层：历史记录 (查询可见)
└── "去年同期对比数据"

第四层：学习反馈 (后台记录)
└── "用户偏好和反馈历史"
```

## 5. 核心算法逻辑

### A. 商品识别算法
```
输入：交易描述 "永辉超市-皇家猫粮1kg"
步骤：
1. 提取关键词 ["皇家", "猫粮", "1kg"]
2. 商品库匹配 → 找到相似商品
3. 用户确认 → 建立映射关系
4. 标准化存储 → "宠物食品-皇家猫粮-1kg"
```

### B. 周期分析算法
```
输入：商品购买时间序列 [2024-01-15, 2024-03-10, 2024-05-05, 2024-06-15]
计算：
1. 间隔天数 [55天, 55天, 41天]
2. 平均间隔 = 50.3天
3. 标准差 = 8.1天
4. 异常检测 → 41天 < (50.3 - 8.1) → 触发提醒
```

### C. 重要性评分算法
```
基础分数 = 变化幅度 × 影响权重
调整因子：
+ 商品重要性 (生活必需品 +0.3)
+ 用户关注度 (历史点击 +0.2)
+ 历史准确性 (用户反馈 +0.1)
- 季节性因素 (-0.2)
- 特殊事件影响 (-0.1)

最终分数 > 0.7 → 立即推送
最终分数 0.3-0.7 → 周报汇总
最终分数 < 0.3 → 静默记录
```

## 6. 典型场景流程

### 场景：猫粮消耗异常检测

```
Step 1: 数据收集
2024-01-15  永辉超市  皇家猫粮1kg  ¥85
2024-03-10  京东商城  皇家猫粮1kg  ¥82
2024-05-05  天猫超市  皇家猫粮1kg  ¥88
2024-06-15  永辉超市  皇家猫粮1kg  ¥86

Step 2: 模式识别
商品：皇家猫粮1kg
购买间隔：55天 → 55天 → 41天
平均间隔：50.3天
异常值：41天 (缩短18%)

Step 3: 置信度评估
- 商品识别准确度：95% ✓
- 数据完整性：100% ✓  
- 变化幅度：18% ✓
- 季节性影响：无 ✓
→ 置信度：高

Step 4: 生成洞察
"检测到猫粮消耗速度加快了18%，可能原因：
1. 猫咪食量增加
2. 商品分量减少
3. 其他宠物加入"

Step 5: 用户交互
推送通知 → 用户点击查看 → 提供详细数据 → 收集反馈
```

## 7. 关键挑战与解决方案

```
挑战1：信息过载
解决：置信度分级 + 用户反馈学习

挑战2：误报率高
解决：多维度验证 + 上下文分析

挑战3：个体差异
解决：个性化模型 + 自适应阈值

挑战4：用户疲劳
解决：渐进式推送 + 可控制选项
```

---

## 核心价值总结

**传统记账软件告诉你：** "你花了多少钱"
**我们的系统告诉你：** "你的消费模式为什么变了，这意味着什么"

**差异化价值：**
- 被动数据 → 主动洞察
- 静态记录 → 动态分析  
- 财务管理 → 生活助手
